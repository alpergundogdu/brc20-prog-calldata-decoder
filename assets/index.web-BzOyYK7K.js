var t=typeof t<"u"?t:{},g={},d;for(d in t)t.hasOwnProperty(d)&&(g[d]=t[d]);var h=t.printErr||console.warn.bind(console);for(d in g)g.hasOwnProperty(d)&&(t[d]=g[d]);var R=(e,n)=>{throw n};g=null;t.arguments&&t.arguments;t.thisProgram&&(thisProgram=t.thisProgram);t.quit&&(R=t.quit);typeof WebAssembly!="object"&&x("no native wasm support detected");var D,T=!1,b,C;function Z(){var e=D.buffer;t.HEAP8=new Int8Array(e),t.HEAPU8=C=new Uint8Array(e)}var L=[],z=[],I=[];function B(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)V(t.preRun.shift());A(L)}function N(){A(z)}function j(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)J(t.postRun.shift());A(I)}function V(e){L.unshift(e)}function q(e){z.unshift(e)}function J(e){I.unshift(e)}var p=0,S=null;function K(e){var n;p++,(n=t.monitorRunDependencies)===null||n===void 0||n.call(t,p)}function X(e){var n;if(p--,(n=t.monitorRunDependencies)===null||n===void 0||n.call(t,p),p==0&&S){var r=S;S=null,r()}}function x(e){var n;(n=t.onAbort)===null||n===void 0||n.call(t,e),e="Aborted("+e+")",h(e),T=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw r}function Q(){return{a:le}}function Y(e){return fetch(e,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+e+"'";return n.arrayBuffer()})}function G(e){var n=Q();function r(a,f){return l=a.exports,D=l.f,Z(),q(l.g),X(),l}K();function i(a){r(a.instance)}function c(a){return Y(e).then(function(f){var u=WebAssembly.instantiate(f,n);return u}).then(a,function(f){h("failed to asynchronously prepare wasm: "+f),x(f)})}function o(){return e&&e.byteLength>0?WebAssembly.instantiate(e,n).then(i,function(a){h("wasm compile failed: "+a)}):typeof WebAssembly.instantiateStreaming=="function"&&typeof e=="string"&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(function(a){var f=WebAssembly.instantiateStreaming(a,n);return f.then(i,function(u){return h("wasm streaming compile failed: "+u),h("falling back to ArrayBuffer instantiation"),c(i)})}):c(i)}if(t.instantiateWasm)try{var s=t.instantiateWasm(n,r);return s}catch(a){return h("Module.instantiateWasm callback failed with error: "+a),!1}return o(),{}}class U{constructor(n){this.name="ExitStatus",this.message=`Program terminated with exit(${n})`,this.status=n}}var A=e=>{for(;e.length>0;)e.shift()(t)},H=t.noExitRuntime||!0,ee=()=>x(""),P=0,te=()=>{H=!1,P=0},v={},F=e=>{if(e instanceof U||e=="unwind")return b;R(1,e)},M=()=>H||P>0,W=e=>{var n;b=e,M()||((n=t.onExit)===null||n===void 0||n.call(t,e),T=!0),R(e,new U(e))},ne=(e,n)=>{b=e,W(e)},re=ne,ie=()=>{if(!M())try{re(b)}catch(e){F(e)}},oe=e=>{if(!T)try{e(),ie()}catch(n){F(n)}},se=()=>performance.now(),ae=(e,n)=>{if(v[e]&&(clearTimeout(v[e].id),delete v[e]),!n)return 0;var r=setTimeout(()=>{delete v[e],oe(()=>$(e,se()))},n);return v[e]={id:r,timeout_ms:n},0},ce=()=>2147483648,ue=(e,n)=>Math.ceil(e/n)*n,fe=e=>{var n=D.buffer,r=(e-n.byteLength+65535)/65536|0;try{return D.grow(r),Z(),1}catch{}},_e=e=>{var n=C.length;e>>>=0;var r=ce();if(e>r)return!1;for(var i=1;i<=4;i*=2){var c=n*(1+.2/i);c=Math.min(c,e+100663296);var o=Math.min(r,ue(Math.max(e,c),65536)),s=fe(o);if(s)return!0}return!1},le={c:ee,b:te,d:ae,e:_e,a:W},l;t._ZSTD_isError=e=>(t._ZSTD_isError=l.h)(e);t._ZSTD_compressBound=e=>(t._ZSTD_compressBound=l.i)(e);t._ZSTD_createCCtx=()=>(t._ZSTD_createCCtx=l.j)();t._ZSTD_freeCCtx=e=>(t._ZSTD_freeCCtx=l.k)(e);t._ZSTD_compress_usingDict=(e,n,r,i,c,o,s,a)=>(t._ZSTD_compress_usingDict=l.l)(e,n,r,i,c,o,s,a);t._ZSTD_compress=(e,n,r,i,c)=>(t._ZSTD_compress=l.m)(e,n,r,i,c);t._ZSTD_createDCtx=()=>(t._ZSTD_createDCtx=l.n)();t._ZSTD_freeDCtx=e=>(t._ZSTD_freeDCtx=l.o)(e);t._ZSTD_getFrameContentSize=(e,n)=>(t._ZSTD_getFrameContentSize=l.p)(e,n);t._ZSTD_decompress_usingDict=(e,n,r,i,c,o,s)=>(t._ZSTD_decompress_usingDict=l.q)(e,n,r,i,c,o,s);t._ZSTD_decompress=(e,n,r,i)=>(t._ZSTD_decompress=l.r)(e,n,r,i);t._malloc=e=>(t._malloc=l.s)(e);t._free=e=>(t._free=l.t)(e);var $=(e,n)=>($=l.v)(e,n),w;S=function e(){w||k(),w||(S=e)};function k(){if(p>0||(B(),p>0))return;function e(){var n;w||(w=!0,t.calledRun=!0,!T&&(N(),(n=t.onRuntimeInitialized)===null||n===void 0||n.call(t),j()))}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),e()},1)):e()}t.run=k;if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();t.init=G;var me=function(e,n,r,i){function c(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(_){try{u(i.next(_))}catch(m){s(m)}}function f(_){try{u(i.throw(_))}catch(m){s(m)}}function u(_){_.done?o(_.value):c(_.value).then(a,f)}u((i=i.apply(e,n||[])).next())})};const de=new Promise(e=>{t.onRuntimeInitialized=e}),pe=()=>me(void 0,void 0,void 0,function*(){yield de}),E=e=>{const n=t._ZSTD_isError;return n(e)},he=(e,n)=>{const r=t._ZSTD_getFrameContentSize;return r(e,n)},De=(e,n={defaultHeapSize:1024*1024})=>{const r=t._malloc,i=r(e.byteLength);t.HEAP8.set(e,i);const c=he(i,e.byteLength),o=c===-1?n.defaultHeapSize:c,s=t._free,a=r(o);try{const f=t._ZSTD_decompress,u=f(a,o,i,e.byteLength);if(E(u))throw new Error(`Failed to compress with code ${u}`);const _=new Uint8Array(t.HEAPU8.buffer,a,u).slice();return s(a,o),s(i,e.byteLength),_}catch(f){throw s(a,o),s(i,e.byteLength),f}},ye=e=>{const n=t._ZSTD_compressBound;return n(e)},we=(e,n)=>{const r=ye(e.byteLength),i=t._malloc,c=i(r),o=i(e.byteLength);t.HEAP8.set(e,o);const s=t._free;try{const a=t._ZSTD_compress,f=a(c,r,o,e.byteLength,n??3);if(E(f))throw new Error(`Failed to compress with code ${f}`);const u=new Uint8Array(t.HEAPU8.buffer,c,f).slice();return s(c,r),s(o,e.byteLength),u}catch(a){throw s(c,r),s(o,e.byteLength),a}},ve=(e,n)=>{const r=t._ZSTD_getFrameContentSize;return r(e,n)},Te=()=>t._ZSTD_createDCtx(),be=e=>t._ZSTD_freeDCtx(e),Ee=(e,n,r,i={defaultHeapSize:1024*1024})=>{const c=t._malloc,o=c(n.byteLength);t.HEAP8.set(n,o);const s=c(r.byteLength);t.HEAP8.set(r,s);const a=ve(o,n.byteLength),f=a===-1?i.defaultHeapSize:a,u=t._free,_=c(f);try{const m=t._ZSTD_decompress_usingDict,y=m(e,_,f,o,n.byteLength,s,r.byteLength);if(E(y))throw new Error(`Failed to compress with code ${y}`);const O=new Uint8Array(t.HEAPU8.buffer,_,y).slice();return u(_,f),u(o,n.byteLength),u(s,r.byteLength),O}catch(m){throw u(_,f),u(o,n.byteLength),u(s,r.byteLength),m}},ge=e=>{const n=t._ZSTD_compressBound;return n(e)},Re=()=>t._ZSTD_createCCtx(),xe=e=>t._ZSTD_freeCCtx(e),Ae=(e,n,r,i)=>{const c=ge(n.byteLength),o=t._malloc,s=o(c),a=o(n.byteLength);t.HEAP8.set(n,a);const f=o(r.byteLength);t.HEAP8.set(r,f);const u=t._free;try{const _=t._ZSTD_compress_usingDict,m=_(e,s,c,a,n.byteLength,f,r.byteLength,i??3);if(E(m))throw new Error(`Failed to compress with code ${m}`);const y=new Uint8Array(t.HEAPU8.buffer,s,m).slice();return u(s,c),u(a,n.byteLength),u(f,r.byteLength),y}catch(_){throw u(s,c),u(a,n.byteLength),u(f,r.byteLength),_}};var Se=function(e,n,r,i){function c(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(_){try{u(i.next(_))}catch(m){s(m)}}function f(_){try{u(i.throw(_))}catch(m){s(m)}}function u(_){_.done?o(_.value):c(_.value).then(a,f)}u((i=i.apply(e,n||[])).next())})};const Ce=e=>Se(void 0,void 0,void 0,function*(){const n=new URL("/assets/zstd-CV7N7xSg.wasm",import.meta.url).href;t.init(e??n),yield pe()});export{we as compress,Ae as compressUsingDict,Re as createCCtx,Te as createDCtx,De as decompress,Ee as decompressUsingDict,xe as freeCCtx,be as freeDCtx,Ce as init};
